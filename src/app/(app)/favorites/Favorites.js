'use client'
import {
  Tabs,
  Tab,
  Row,
  Breadcrumb,
  BreadcrumbItem,
  Container,
  Button,
  Image,
  Col,
} from 'react-bootstrap'
import { useEffect, useState } from 'react'
import FavoriteItem from './FavoriteItem'
import { useFavorites } from '@/hooks/useFavorites'
import { useAuth } from '@/hooks/auth'
import LoadingSpinner from '@/components/layout/LoadingSpinner'

export default function Favorites() {
  const { user } = useAuth({ middleware: 'auth' })
  const { getFavoriteProducts } = useFavorites()
  const [favorites, setFavorites] = useState([])
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    const loadUserFavoriteItems = async () => {
      if (user?.favorite_id) {
        const items = await getFavoriteProducts(user?.favorite_id)
        setFavorites(items || [])
        setLoading(false)
      }
    }

    loadUserFavoriteItems()
  }, [user])

  const [key, setKey] = useState('favorites')

  if (!user || loading) return <LoadingSpinner />

  return (
    <div>
      <small>
        <Breadcrumb style={{ '--bs-breadcrumb-divider': "'>'" }}>
          <BreadcrumbItem href="#">
            <span className="text-decoration-none">Compras</span>
          </BreadcrumbItem>
          <BreadcrumbItem href="#">Favoritos</BreadcrumbItem>
        </Breadcrumb>
      </small>
      <div className="d-flex justify-content-between align-items-center">
        <h4 className="mt-4">Favoritos</h4>
        <Button className="primary">+ Crear lista</Button>
      </div>
      <Tabs
        id="Controlled-Tab-favs"
        activeKey={key}
        onSelect={k => setKey(k)}
        className="mb-3">
        <Tab eventKey="favorites" title="Favoritos">
          {favorites.length > 0 ? (
            favorites.map(product => (
              <FavoriteItem
                key={product.id}
                title={product.title}
                price={product.price}
                hasFreeShipping={product.hasFreeShipping}
              />
            ))
          ) : (
            <Container
              className="
              bg-disabled-meli
              d-flex
              flex-column
              align-items-center
              justify-content-center
              text-center"
              style={{ height: '100vh' }}>
              <div
                className="mb-3 d-flex justify-content-center align-items-center"
                style={{
                  width: '88px',
                  height: '88px',
                  borderRadius: '50%',
                  backgroundColor: '#EEEEEE',
                }}>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="45"
                  height="45"
                  fill="currentColor"
                  className="bi bi-heart"
                  viewBox="0 0 16 16">
                  <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15" />
                </svg>
              </div>
              <h5 className="mb-2">Aún no tienes productos favoritos</h5>
              <p className="text-muted">
                Agrégalos haciendo clic en el corazón de la página de producto
              </p>
            </Container>
          )}
        </Tab>
        <Tab eventKey="lists" title="Listas">
          <Container
            className="
            bg-disabled-meli
            d-flex
            flex-column
            align-items-center
            justify-content-center
            text-center"
            style={{ height: '100vh' }}>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="118"
              height="88"
              viewBox="0 0 118 88"
              fill="none">
              <path
                d="M0.75 27.8516C0.75 26.747 1.64543 25.8516 2.75 25.8516H114.37C115.474 25.8516 116.37 26.747 116.37 27.8516V43.6721C116.37 44.7766 115.474 45.6721 114.37 45.6721H2.75C1.64543 45.6721 0.75 44.7766 0.75 43.6721V27.8516Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M3.75 28.8516V42.6721H113.37V28.8516H3.75ZM2.75 25.8516C1.64543 25.8516 0.75 26.747 0.75 27.8516V43.6721C0.75 44.7766 1.64543 45.6721 2.75 45.6721H114.37C115.474 45.6721 116.37 44.7766 116.37 43.6721V27.8516C116.37 26.747 115.474 25.8516 114.37 25.8516H2.75Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M0 27.8516C0 26.3328 1.23122 25.1016 2.75 25.1016H114.37C115.888 25.1016 117.12 26.3328 117.12 27.8516V43.6721C117.12 45.1909 115.888 46.4221 114.37 46.4221H2.75C1.23122 46.4221 0 45.1909 0 43.6721V27.8516ZM2.75 26.6016C2.05965 26.6016 1.5 27.1612 1.5 27.8516V43.6721C1.5 44.3624 2.05964 44.9221 2.75 44.9221H114.37C115.06 44.9221 115.62 44.3624 115.62 43.6721V27.8516C115.62 27.1612 115.06 26.6016 114.37 26.6016H2.75Z"
                fill="#333333"></path>
              <path
                d="M1.12891 2.75C1.12891 1.64543 2.02434 0.75 3.12891 0.75H114.749C115.853 0.75 116.749 1.64543 116.749 2.75V18.5705C116.749 19.6751 115.853 20.5705 114.749 20.5705H3.12891C2.02434 20.5705 1.12891 19.6751 1.12891 18.5705V2.75Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M4.12891 3.75V17.5705H113.749V3.75H4.12891ZM3.12891 0.75C2.02434 0.75 1.12891 1.64543 1.12891 2.75V18.5705C1.12891 19.6751 2.02434 20.5705 3.12891 20.5705H114.749C115.853 20.5705 116.749 19.6751 116.749 18.5705V2.75C116.749 1.64543 115.853 0.75 114.749 0.75H3.12891Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M0.378906 2.75C0.378906 1.23122 1.61012 0 3.12891 0H114.749C116.267 0 117.499 1.23122 117.499 2.75V5.8837H115.999V2.75C115.999 2.05964 115.439 1.5 114.749 1.5H3.12891C2.43855 1.5 1.87891 2.05965 1.87891 2.75V18.5705C1.87891 19.2609 2.43855 19.8205 3.12891 19.8205H114.749C115.439 19.8205 115.999 19.2609 115.999 18.5705V12.103H117.499V18.5705C117.499 20.0893 116.267 21.3205 114.749 21.3205H3.12891C1.61012 21.3205 0.378906 20.0893 0.378906 18.5705V2.75ZM115.999 8.1813H117.499V9.9763H115.999V8.1813Z"
                fill="#333333"></path>
              <path
                d="M0.75 52.9531C0.75 51.8486 1.64543 50.9531 2.75 50.9531H114.37C115.474 50.9531 116.37 51.8486 116.37 52.9531V68.113C116.37 69.2175 115.474 70.113 114.37 70.113H2.75C1.64543 70.113 0.75 69.2175 0.75 68.113V52.9531Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M3.75 53.9531V67.113H113.37V53.9531H3.75ZM2.75 50.9531C1.64543 50.9531 0.75 51.8486 0.75 52.9531V68.113C0.75 69.2175 1.64543 70.113 2.75 70.113H114.37C115.474 70.113 116.37 69.2175 116.37 68.113V52.9531C116.37 51.8486 115.474 50.9531 114.37 50.9531H2.75Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M0.378906 52.9531C0.378906 51.4343 1.61012 50.2031 3.12891 50.2031H114.749C116.267 50.2031 117.499 51.4343 117.499 52.9531V68.113C117.499 69.6317 116.267 70.863 114.749 70.863H3.12891C1.61012 70.863 0.378906 69.6317 0.378906 68.113V66.7155H1.87891V68.113C1.87891 68.8033 2.43855 69.363 3.12891 69.363H114.749C115.439 69.363 115.999 68.8033 115.999 68.113V52.9531C115.999 52.2628 115.439 51.7031 114.749 51.7031H3.12891C2.43855 51.7031 1.87891 52.2628 1.87891 52.9531V64.4897H0.378906V52.9531Z"
                fill="#333333"></path>
              <path
                d="M81.2227 51.4277L96.5248 66.3204L93.9797 68.7974L78.6776 53.9047L81.2227 51.4277Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M81.2227 50.3818L97.5997 66.3207L93.9797 69.8438L77.6026 53.905L81.2227 50.3818ZM81.2227 52.4742L79.7525 53.905L93.9797 67.7515L95.4498 66.3207L81.2227 52.4742Z"
                fill="#333333"></path>
              <path
                d="M89.7142 34.0849C89.7142 49.5958 76.7945 62.1698 60.8571 62.1698C44.9198 62.1698 32 49.5958 32 34.0849C32 18.574 44.9198 6 60.8571 6C76.7945 6 89.7142 18.574 89.7142 34.0849Z"
                fill="white"></path>
              <path
                d="M83.0434 34.0842C83.0434 46.0092 73.1105 55.6763 60.8576 55.6763C48.6048 55.6763 38.6719 46.0092 38.6719 34.0842C38.6719 22.1593 48.6048 12.4922 60.8576 12.4922C73.1105 12.4922 83.0434 22.1593 83.0434 34.0842Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M60.8576 52.6763C71.5308 52.6763 80.0434 44.2762 80.0434 34.0842C80.0434 23.8923 71.5308 15.4922 60.8576 15.4922C50.1844 15.4922 41.6719 23.8923 41.6719 34.0842C41.6719 44.2762 50.1844 52.6763 60.8576 52.6763ZM60.8576 55.6763C73.1105 55.6763 83.0434 46.0092 83.0434 34.0842C83.0434 22.1593 73.1105 12.4922 60.8576 12.4922C48.6048 12.4922 38.6719 22.1593 38.6719 34.0842C38.6719 46.0092 48.6048 55.6763 60.8576 55.6763Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M60.8571 6.75C45.3147 6.75 32.75 19.0073 32.75 34.0849C32.75 49.1625 45.3147 61.4198 60.8571 61.4198C76.3995 61.4198 88.9642 49.1625 88.9642 34.0849C88.9642 19.0073 76.3995 6.75 60.8571 6.75ZM31.25 34.0849C31.25 18.1408 44.5249 5.25 60.8571 5.25C77.1894 5.25 90.4642 18.1408 90.4642 34.0849C90.4642 50.029 77.1894 62.9198 60.8571 62.9198C44.5249 62.9198 31.25 50.029 31.25 34.0849Z"
                fill="#333333"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M60.8576 13.2422C48.9997 13.2422 39.4219 22.5925 39.4219 34.0842C39.4219 45.5759 48.9997 54.9263 60.8576 54.9263C72.7156 54.9263 82.2934 45.5759 82.2934 34.0842C82.2934 22.5925 72.7156 13.2422 60.8576 13.2422ZM37.9219 34.0842C37.9219 21.726 48.2099 11.7422 60.8576 11.7422C73.5054 11.7422 83.7934 21.726 83.7934 34.0842C83.7934 46.4425 73.5054 56.4263 60.8576 56.4263C48.2099 56.4263 37.9219 46.4425 37.9219 34.0842Z"
                fill="#333333"></path>
              <path
                d="M90.5902 58.2269C91.3817 57.4566 92.6651 57.4566 93.4567 58.2269L114.517 78.7238C115.309 79.4942 115.309 80.7432 114.517 81.5136L109.593 86.3055C108.802 87.0759 107.519 87.0759 106.727 86.3055L85.6665 65.8087C84.875 65.0383 84.875 63.7892 85.6665 63.0188L90.5902 58.2269Z"
                fill="#EEEEEE"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M92.0234 61.0168L88.533 64.4137L108.16 83.5157L111.651 80.1187L92.0234 61.0168ZM93.4567 58.2269C92.6651 57.4566 91.3817 57.4566 90.5902 58.2269L85.6665 63.0188C84.875 63.7892 84.875 65.0383 85.6665 65.8087L106.727 86.3055C107.519 87.0759 108.802 87.0759 109.593 86.3055L114.517 81.5136C115.309 80.7432 115.309 79.4942 114.517 78.7238L93.4567 58.2269Z"
                fill="white"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M90.0527 57.7041C91.1411 56.6448 92.9058 56.6449 93.9942 57.7041L115.055 78.201C116.143 79.2603 116.143 80.9777 115.055 82.037L110.131 86.8289C109.043 87.8882 107.278 87.8882 106.189 86.8289L85.129 66.332C84.0406 65.2727 84.0406 63.5553 85.1291 62.496L90.0527 57.7041ZM92.9192 58.7503C92.4245 58.2688 91.6224 58.2688 91.1277 58.7503L86.204 63.5422C85.7093 64.0237 85.7093 64.8044 86.204 65.2858L107.264 85.7827C107.759 86.2642 108.561 86.2642 109.056 85.7827L113.98 80.9908C114.474 80.5093 114.474 79.7287 113.98 79.2472L92.9192 58.7503Z"
                fill="#333333"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M61.3021 26.8635C62.3513 25.7277 63.7098 25.082 65.6201 25.082C69.2945 25.082 71.8008 27.3314 71.8008 31.6388C71.8008 31.7225 71.799 31.8063 71.7954 31.8904C71.6773 34.6036 69.7273 37.3805 66.574 40.1386C65.4621 41.1112 64.2739 42.0132 63.0857 42.8235C62.6697 43.1072 62.2829 43.3595 61.935 43.5776C61.7242 43.7098 61.5718 43.802 61.4872 43.8515L61.0528 44.106L60.6183 43.8515L60.6087 43.8459L60.5849 43.8318C60.5496 43.8107 60.5496 43.8107 60.4967 43.7788C60.4021 43.7216 60.293 43.6544 60.1705 43.5776C59.8226 43.3595 59.4359 43.1072 59.0198 42.8235C57.8317 42.0132 56.6434 41.1112 55.5315 40.1386C52.3782 37.3805 50.4283 34.6036 50.3102 31.8904C50.3065 31.8063 50.3047 31.7225 50.3047 31.6388C50.3047 27.3314 52.811 25.082 56.4854 25.082C58.3957 25.082 59.7542 25.7277 60.8034 26.8635C60.8659 26.9311 60.9544 27.0367 61.0528 27.1583C61.1512 27.0367 61.2396 26.9311 61.3021 26.8635Z"
                fill="#EEEEEE"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M59.9677 26.1154C60.2675 26.3335 60.5449 26.5836 60.8034 26.8635C60.8659 26.9311 60.9544 27.0367 61.0528 27.1583C61.1512 27.0367 61.2396 26.9311 61.3021 26.8635C61.5607 26.5836 61.838 26.3335 62.1378 26.1154C63.0544 25.4487 64.1806 25.082 65.6201 25.082C69.2945 25.082 71.8008 27.3314 71.8008 31.6388C71.8008 31.7225 71.799 31.8063 71.7954 31.8904C71.6773 34.6036 69.7273 37.3805 66.574 40.1386C65.4621 41.1112 64.2739 42.0132 63.0857 42.8235C62.6697 43.1072 62.2829 43.3595 61.935 43.5776C61.7242 43.7098 61.5718 43.802 61.4872 43.8515L61.0528 44.106L60.6183 43.8515L60.6087 43.8459L60.5849 43.8318C60.5496 43.8107 60.5496 43.8107 60.4967 43.7788C60.4021 43.7216 60.293 43.6544 60.1705 43.5776C59.8226 43.3595 59.4359 43.1072 59.0198 42.8235C57.8317 42.0132 56.6434 41.1112 55.5315 40.1386C52.3782 37.3805 50.4283 34.6036 50.3102 31.8904C50.3065 31.8063 50.3047 31.7225 50.3047 31.6388C50.3047 27.3314 52.811 25.082 56.4854 25.082C57.925 25.082 59.0511 25.4487 59.9677 26.1154ZM61.0528 42.3601C61.0252 42.343 60.9967 42.3252 60.9673 42.3067C60.6363 42.0992 60.2657 41.8575 59.865 41.5842C58.7191 40.8027 57.5795 39.9371 56.5191 39.0096C53.4322 36.3095 51.8987 33.8917 51.8088 31.8252C51.806 31.7626 51.8047 31.7005 51.8047 31.6388C51.8047 29.7757 52.3412 28.5526 53.085 27.7986C53.8288 27.0446 54.9548 26.582 56.4854 26.582C57.9959 26.582 58.9487 27.0663 59.7016 27.8814C59.7284 27.9103 59.7906 27.9831 59.8868 28.1019L61.0528 29.5427L62.2188 28.1019C62.315 27.9831 62.3772 27.9103 62.4039 27.8814C63.1568 27.0663 64.1097 26.582 65.6201 26.582C67.1507 26.582 68.2767 27.0446 69.0205 27.7986C69.7643 28.5526 70.3008 29.7757 70.3008 31.6388C70.3008 31.7005 70.2995 31.7626 70.2968 31.8252C70.2068 33.8917 68.6734 36.3095 65.5864 39.0096C64.526 39.9371 63.3865 40.8027 62.2405 41.5842C61.8399 41.8575 61.4692 42.0992 61.1383 42.3067C61.1084 42.3255 61.0799 42.3433 61.0528 42.3601Z"
                fill="#EEEEEE"></path>
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M61.3021 26.8635C62.3513 25.7277 63.7098 25.082 65.6201 25.082C69.2945 25.082 71.8008 27.3314 71.8008 31.6388C71.8008 31.7225 71.799 31.8063 71.7954 31.8904C71.6773 34.6036 69.7273 37.3805 66.574 40.1386C65.4621 41.1112 64.2739 42.0132 63.0857 42.8235C62.6697 43.1072 62.2829 43.3595 61.935 43.5776C61.7242 43.7098 61.5718 43.802 61.4872 43.8515L61.0528 44.106L60.6183 43.8515L60.6087 43.8459L60.5849 43.8318C60.5496 43.8107 60.5496 43.8107 60.4967 43.7788C60.4021 43.7216 60.293 43.6544 60.1705 43.5776C59.8226 43.3595 59.4359 43.1072 59.0198 42.8235C57.8317 42.0132 56.6434 41.1112 55.5315 40.1386C52.3782 37.3805 50.4283 34.6036 50.3102 31.8904C50.3065 31.8063 50.3047 31.7225 50.3047 31.6388C50.3047 27.3314 52.811 25.082 56.4854 25.082C58.3957 25.082 59.7542 25.7277 60.8034 26.8635C60.8659 26.9311 60.9544 27.0367 61.0528 27.1583C61.1512 27.0367 61.2396 26.9311 61.3021 26.8635Z"
                stroke="#333333"
                stroke-width="1.5"></path>
            </svg>
            <h5>Empieza a crear listas con tus productos favoritos</h5>
            <p className="mb-2">
              Organiza y agrupa los productos favoritos como profieras.
            </p>
            <Button>Crear tu primera lista</Button>
          </Container>
        </Tab>
      </Tabs>
    </div>
  )
}
